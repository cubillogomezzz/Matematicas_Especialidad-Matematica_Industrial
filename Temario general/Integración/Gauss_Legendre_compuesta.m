% --- Gauss-Legendre compuesta con n en --- 

f = @(x) sin(pi*x);

a=0;
b=1;

n=1; %1,2 o 3 y descomentar adecuadamente
k=4;

h=(b-a)/k;
g = @(t,i) h*0.5*f(h*0.5*t+h*(i-0.5)); % transformacion afin para pasar de -1 1,
%a un subintervalo i, equiespaciados. 

%nodos y pesos para distinto numero de puntos n
%grado de precisi√≥n m=2n-1

% xi = [0]; %n=1
% wi = [2];

% xi = [-sqrt(3)/3 sqrt(3)/3]; %n=2
% wi = [1 1];

xi = [-sqrt(3/5) 0 sqrt(3/5)]; %n=3
wi = [5/9 8/9 5/9];

%n=4
% xi = [-0.8611363115940526 -0.3399810435848563 0.8611363115940526 0.3399810435848563]
% wi = [0.3478548451374538 0.6521451548625461 0.3478548451374538 0.6521451548625461]

%n=8 

xi = [-0.9602898564975363 -0.7966664774136267 -0.5255324099163290 -0.1834346424956498 0.1834346424956498 0.5255324099163290 0.7966664774136267 0.9602898564975363];
wi = [0.1012285362903763 0.2223810344533745 0.3137066458778873 0.3626837833783620 0.3626837833783620 0.3137066458778873 0.2223810344533745 0.1012285362903763];

Qf=0;

for i=1:k
    
    Qf = Qf + sum(wi.*g(xi,i));

end

Qf
